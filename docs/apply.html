<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apply ‚Äì Bridgi</title>
    <link rel="stylesheet" href="./styles.css">
</head>

<body>

    <!-- HEADER -->
    <header class="site-header">
        <div class="container header-inner">
            <a href="./index.html" class="logo-group">
                <img src="./utils/logo-bridgi.jpeg" alt="Bridgi logo" class="logo" />
            </a>

            <!-- Desktop nav -->
            <!-- <nav class="main-nav">
                <a href="#how-it-works">How it works</a>
                <a href="#match">Find your match</a>
                <a href="#why">Why Bridgi?</a>
                <a href="#about">About</a>
                <a href="#faq">FAQ</a>
                <a href="#contact-section" class="nav-cta">Schedule a meeting</a>
            </nav> -->

            <!-- Burger mobile -->
            <button class="burger" type="button" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </header>

    <!-- Mobile nav -->
    <nav class="mobile-nav">
        <a href="#how-it-works">How it works</a>
        <a href="#match">Find your match</a>
        <a href="#why">Why Bridgi?</a>
        <a href="#about">About</a>
        <a href="#faq">FAQ</a>
        <a href="#contact-section" class="mobile-cta">Schedule a meeting</a>
    </nav>

    <main>

        <!-- PAGE TITLE -->
        <section class="section intro-section beige-bg">
            <div class="container">
                <h1 class="section-title">Apply to join Bridgi</h1>
                <p class="section-subtitle">
                    At Bridgi, we are here to bridge the gap between great companies and great freelancers. We
                    connect you with the company best suited to your skills.
                </p>
            </div>
        </section>

        <!-- APPLY CONTENT -->
        <form class="apply-form" id="apply-form" enctype="multipart/form-data">

            <!-- Name fields -->
            <div class="form-row">
                <div class="form-group">
                    <label>First name</label>
                    <input type="text" name="firstName" placeholder="John" required>
                </div>

                <div class="form-group">
                    <label>Last name</label>
                    <input type="text" name="lastName" placeholder="Doe" required>
                </div>
            </div>

            <!-- Email -->
            <div class="form-group">
                <label>Email</label>
                <input type="email" name="email" placeholder="you@example.com" required>
            </div>

            <!-- Availability -->
            <div class="form-group">
                <label>Availability</label>
                <input type="date" name="availability" required>
            </div>

            <!-- LANGUAGES -->
            <div class="form-block">
                <h4>Languages</h4>

                <label class="checkbox-row">
                    <input type="checkbox" name="lang" value="French">
                    <span>French (FR)</span>
                </label>

                <label class="checkbox-row">
                    <input type="checkbox" name="lang" value="English">
                    <span>English (EN)</span>
                </label>

                <label class="checkbox-row">
                    <input type="checkbox" name="lang" value="Dutch">
                    <span>Dutch (NL)</span>
                </label>

                <label class="checkbox-row">
                    <input type="checkbox" id="lang-other">
                    <span>Autres</span>
                </label>

                <input type="text" id="other-lang-input" name="otherLanguage" placeholder="Specify language‚Ä¶"
                    class="hidden">
            </div>

            <!-- ROLES -->
            <div class="form-group">
                <label for="mission_preferences">
                    What kind of missions would you like to work on, and why?
                    <span class="label-hint">
                        (roles, industries, environment, duration, level of responsibility)
                    </span>
                </label>

                <textarea id="mission_preferences" name="mission_preferences" rows="5"
                    placeholder="Tell us what motivates you, what you‚Äôre looking for, and the type of missions where you feel you bring the most value."
                    required></textarea>

                <p class="form-note">
                    * There is no ‚Äúright‚Äù answer here. This helps us understand you better before reaching out.
                </p>
            </div>

            <!-- CV UPLOAD -->
            <div class="form-group">
                <label for="cv">Upload your CV (PDF)</label>

                <div class="file-upload">
                    <input type="file" id="cv" name="cv" accept=".pdf" required />
                    <label for="cv" class="file-upload-btn">
                        Upload PDF
                    </label>
                    <span id="file-name" class="file-name">No file selected</span>
                </div>
            </div>
            <input type="hidden" name="_subject" value="New Bridgi application">


            <button type="submit" class="apply-submit">Submit application</button>
            <p id="apply-status" class="form-status" aria-live="polite"></p>


        </form>

    </main>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="container footer-grid">
            <div class="footer-logo-block">
                <img src="./utils/logo-white.jpeg" class="footer-logo" alt="Bridgi logo" />
            </div>

            <div class="footer-column">
                <h4>Contact</h4>
                <p>
                    4 Rue de l‚ÄôErmitage<br />
                    1050 Ixelles<br />
                    +32 499 28 42 04<br />
                    <a href="mailto:romain.cotton@bridgi.be">romain.cotton@bridgi.be</a>
                </p>
            </div>

            <div class="footer-column">
                <h4>Connect</h4>
                <a href="https://www.linkedin.com/in/romain-cotton-375b2a180/" target="_blank">LinkedIn</a>
            </div>
        </div>

        <div class="footer-bottom">
            ¬© 2025 Bridgi. All rights reserved.
        </div>
    </footer>

    <script>
        const cvInput = document.getElementById("cv");
        const fileNameSpan = document.getElementById("file-name");

        cvInput.addEventListener("change", () => {
            if (cvInput.files.length > 0) {
                fileNameSpan.textContent = cvInput.files[0].name;
            } else {
                fileNameSpan.textContent = "No file selected";
            }
        });
        const form = document.getElementById("apply-form");
        const statusEl = document.getElementById("apply-status");

        const langOther = document.getElementById("lang-other");
        const otherInput = document.getElementById("other-lang-input");

        langOther.addEventListener("change", () => {
            otherInput.classList.toggle("hidden", !langOther.checked);
        });

        const API_URL = "http://localhost:3000/api/apply";

        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            console.log("üöÄ Submit triggered");

            statusEl.textContent = "Sending‚Ä¶";

            const fd = new FormData(form);

            // Collect languages
            const languages = [...document.querySelectorAll('input[name="lang"]:checked')]
                .map(el => el.value)
                .join(", ");

            fd.set("languages", languages);

            try {
                const res = await fetch(API_URL, {
                    method: "POST",
                    body: fd
                });

                const data = await res.json();
                console.log("‚¨ÖÔ∏è Response:", data);

                if (!res.ok || !data.ok) {
                    throw new Error(data.error || "Submission failed");
                }

                statusEl.textContent = "‚úÖ Application sent. We‚Äôll get back to you soon.";
                form.reset();

            } catch (err) {
                console.error(err);
                statusEl.textContent = "‚ùå Error sending application.";
            }
        });
    </script>

</body>

</html>